<!DOCTYPE html>
<html>
<head>
  <title>BudgetApp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>

<body>
<% if user_signed_in? %>
  <!-- Default Navigation Bar -->
  <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light bg-primary text-white ">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse vh-100" id="navbarNavAltMarkup" style="max-height: 100vh;">
        <div class="navbar-nav">
          <%= link_to "Home", root_path, class: "nav-link active", "aria-current" => "page" %>
          <% if user_signed_in? %>
            <li class="nav-item">
              <%= link_to "Hi, #{current_user.email}", edit_user_registration_path, class: 'nav-link' %>
            </li>
            <li class="nav-item">
              <%= button_to 'Sign Out', destroy_user_session_path, method: :delete, class: 'nav-link' %>
            </li>
          <% else %>
            <li class="nav-item">
              <%= link_to 'Sign In', new_user_session_path, class: 'nav-link' %>
            </li>
            <li class="nav-item">
              <%= link_to 'Sign Up', new_user_registration_path, class: 'nav-link' %>
            </li>
          <% end %>
        </div>
      </div>
      <%= link_to "Budget app", root_path, class: "navbar-brand" %>
    </div>
  </nav>
<% end %>

<% if controller_name == 'sessions' && action_name == 'new' %>
  <!-- Sign In Navigation Bar -->
  <nav class="navbar navbar-light bg-light bg-primary text-white">
    <div class="container align-items-baseline">
      <%= link_to root_path, class: "navbar-brand" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="white" class="bi bi-arrow-left" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M13.5 8a.5.5 0 0 0-.5-.5H2.707l2.146-2.146a.5.5 0 0 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L2.707 8.5H13a.5.5 0 0 0 .5-.5z"/>
        </svg>
      <% end %>
      <h2 class="navbar-text text-white">LOGIN</h2>
        <%= link_to "Log in", "#", class: "btn btn-link text-white link", onclick: "document.getElementById('login-form').submit();" %>
    </div>
  </nav>
<% end %>
<% if controller_name == 'registrations' && (action_name == 'new' || action_name == 'create') %>
  <!-- Sign Up Navigation Bar -->
  <nav class="navbar navbar-light bg-light bg-primary text-white">
    <div class="container align-items-baseline">
      <%= link_to root_path, class: "navbar-brand" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="white" class="bi bi-arrow-left" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M13.5 8a.5.5 0 0 0-.5-.5H2.707l2.146-2.146a.5.5 0 0 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L2.707 8.5H13a.5.5 0 0 0 .5-.5z"/>
        </svg>
      <% end %>
      <h2 class="navbar-text text-white">REGISTER</h2>
      <%= link_to "Sign up", "#", class: "btn btn-primary", onclick: "document.getElementById('signup-form').submit();" %>
    </div>
  </nav>
<% end %>


<div class="container mt-5">
  <div class="text-center mb-5 ">
    <% flash.each do |name, msg| %>
      <% alert_class = name == 'error' ? 'alert-danger' : 'alert-success' %>
      <%= content_tag :div, msg, id: "flash_#{name}", class: "alert #{alert_class}" %>
    <% end %>
  </div>

  <%= yield %>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

<script>
    document.addEventListener("turbolinks:load", function () {
        // Enable Bootstrap collapse for the navbar
        let navbarCollapse = new bootstrap.Collapse(document.getElementById('navbarNavAltMarkup'), {
            toggle: false // Disable the automatic toggling behavior
        });

        // // Set the height of the collapsed element to 100vh
        // let element = document.querySelector('.full-height');
        //
        // element.style.height = "100vh";

        // Handle click events on nav links
        let navLinks = document.querySelectorAll('#navbarNavAltMarkup .nav-link');
        navLinks.forEach(function (navLink) {
            navLink.addEventListener('click', function (event) {
                event.preventDefault();

                // Remove 'active' class from all nav links
                navLinks.forEach(function (link) {
                    link.classList.remove('active');
                });

                // Add 'active' class to the clicked nav link
                this.classList.add('active');

                // Close the navbar if it's open
                navbarCollapse.hide();
            });
        });
    });
</script>


</body>
</html>
